{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Custodian Licence Record",
  "description": "Schema for public custodian licence records published by the CAM Initiative.",
  "type": "object",
  "required": [
    "license_id",
    "scope",
    "level",
    "expiry",
    "hash",
    "signer_id",
    "public_key_id",
    "issued_at",
    "revoked"
  ],
  "properties": {
    "license_id": {
      "type": "string",
      "description": "Unique identifier for the licence."
    },
    "scope": {
      "type": "string",
      "description": "Licence scope (e.g. Reflection, Invocation, Covenant, Custodian)."
    },
    "level": {
      "type": "integer",
      "minimum": 1,
      "description": "Licence level (1–4), corresponding to the certification tier."
    },
    "expiry": {
      "type": "string",
      "format": "date-time",
      "description": "ISO‑8601 expiry timestamp."
    },
    "hash": {
      "type": "string",
      "description": "Base64‑encoded SHA‑256 digest of the canonical declaration."
    },
    "signer_id": {
      "type": "string",
      "description": "Identifier of the signing authority (e.g. Aeon Tribunal)."
    },
    "public_key_id": {
      "type": "string",
      "description": "Key ID used to verify the signature (corresponds to an entry in jwks.json)."
    },
    "revoked": {
      "type": "boolean",
      "description": "Indicates whether the licence has been revoked."
    },
    "issued_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO‑8601 timestamp of initial issuance."
    },
    "version": {
      "type": "string",
      "description": "Version string for the licence record."
    },
    "links": {
      "type": "object",
      "description": "References linking the public record to its source.  All fields optional.",
      "properties": {
        "public_commit": { "type": "string", "description": "Commit hash or URL for the public record" },
        "private_registry_ref": { "type": "string", "description": "Path to the corresponding private ledger entry" }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": true
}